var A=Object.defineProperty;var c=(s,t,i)=>t in s?A(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i;var n=(s,t,i)=>c(s,typeof t!="symbol"?t+"":t,i);const l=(s,t,i)=>s>=t&&s<=i;class e{constructor(t,i){n(this,"x");n(this,"y");this.x=t,this.y=i}add(t){return new e(this.x+t.x,this.y+t.y)}subtract(t){return new e(this.x-t.x,this.y-t.y)}distanceTo(t){return t.subtract(this).getLength()}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}getLength(){return Math.sqrt(this.x*this.x+this.y*this.y)}equals(t){return this.x==t.x&&this.y===t.y}modulo(t){return new e(this.x%t.x,this.y%t.y)}multiply(t){return new e(this.x*t,this.y*t)}isInBound(t,i,a,r){return l(this.x,t,i)&&l(this.y,a,r)}getAdjacent(){return[new e(this.x+1,this.y),new e(this.x-1,this.y),new e(this.x,this.y+1),new e(this.x,this.y-1)]}toString(){return`${this.x},${this.y}`}copy(){return new e(this.x,this.y)}}const u=(s,t,i)=>s+(t-s)*i,w=(s,t,i)=>new e(u(s.x,t.x,i),u(s.y,t.y,i));class h{constructor({getCurrentValue:t,targetValue:i,duration:a,delay:r=0,onFinish:o}){n(this,"startValue");n(this,"getCurrentValue");n(this,"targetValue");n(this,"startTime");n(this,"duration");n(this,"onFinish");n(this,"isFinished");this.startValue=null,this.getCurrentValue=t,this.targetValue=i,this.duration=a,this.startTime=Date.now()+r,this.isFinished=!1,this.onFinish=o}get runningTime(){return Date.now()-this.startTime}hasStarted(){return this.runningTime>=0}isVectorAnimation(){return this.targetValue instanceof e}isNumberAnimation(){return typeof this.targetValue=="number"}tick(){var i;const t=this.runningTime/this.duration;if(!this.hasStarted())return this.getCurrentValue();if(this.runningTime>=this.duration)return this.isFinished=!0,(i=this.onFinish)==null||i.call(this,this.targetValue),this.targetValue;if(this.startValue===null)return this.startValue=this.getCurrentValue(),this.startValue;if(this.isVectorAnimation())return w(this.startValue,this.targetValue,t);if(this.isNumberAnimation())return u(this.startValue,this.targetValue,t);throw new Error("Invalid animation")}}class V{constructor({ctx:t,label:i,position:a,fontSize:r=24,fontFamily:o="Inter",color:g=getComputedStyle(t.canvas).getPropertyValue("--fg"),rotation:m=0,opacity:y=1,textAlign:p="center",rotationOrigin:d="center",keepDrawingAfterAnimation:f=!1}){n(this,"ctx");n(this,"label");n(this,"font");n(this,"textAlign");n(this,"color");n(this,"positionAnimations");n(this,"position");n(this,"opacityAnimations");n(this,"opacity");n(this,"rotationAnimations");n(this,"rotation");n(this,"rotationOrigin");n(this,"keepDrawingAfterAnimation");this.ctx=t,this.label=i,this.font=`${r}px ${o}`,this.color=g,this.textAlign=p,this.positionAnimations=[],this.position=a,this.opacityAnimations=[],this.opacity=y,this.rotationAnimations=[],this.rotation=m,this.rotationOrigin=d,this.keepDrawingAfterAnimation=f}animatePosition(t,i,{delay:a,onFinish:r}={}){return this.positionAnimations.push(new h({getCurrentValue:()=>this.position,targetValue:t,duration:i,delay:a,onFinish:r})),this}animateOpacity(t,i,{delay:a,onFinish:r}={}){return this.opacityAnimations.push(new h({getCurrentValue:()=>this.opacity,targetValue:t,duration:i,delay:a,onFinish:r})),this}animateRotation(t,i,{delay:a,onFinish:r}={}){return this.rotationAnimations.push(new h({getCurrentValue:()=>this.rotation,targetValue:t,duration:i,delay:a,onFinish:r})),this}update(){for(const t of this.positionAnimations)!t.hasStarted()||t.isFinished||(this.position=t.tick());for(const t of this.opacityAnimations)!t.hasStarted()||t.isFinished||(this.opacity=t.tick());for(const t of this.rotationAnimations)!t.hasStarted()||t.isFinished||(this.rotation=t.tick())}draw(t){t.save(),t.textAlign=this.textAlign,t.textBaseline="middle",t.globalAlpha=this.opacity,t.fillStyle=this.color,t.font=this.font;const i=t.measureText(this.label).width;this.rotationOrigin==="left"&&t.translate(-i/2,0),this.rotationOrigin==="right"&&t.translate(i/2,0),t.translate(this.position.x,this.position.y),t.rotate(this.rotation),this.rotationOrigin==="left"&&t.translate(i/2,0),this.rotationOrigin==="right"&&t.translate(-i/2,0),t.fillText(this.label,0,0),t.restore()}tick(){return this.update(),this.draw(this.ctx),(this.opacityAnimations.every(t=>t.isFinished)??!0)&&(this.positionAnimations.every(t=>t.isFinished)??!0)&&(this.rotationAnimations.every(t=>t.isFinished)??!0)}}export{V as A,h as F,e as V,l as i};
