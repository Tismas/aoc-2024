var p=Object.defineProperty;var f=(s,t,i)=>t in s?p(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i;var n=(s,t,i)=>f(s,typeof t!="symbol"?t+"":t,i);class h{constructor(t,i){n(this,"x");n(this,"y");this.x=t,this.y=i}subtract(t){return new h(this.x-t.x,this.y-t.y)}distanceTo(t){return t.subtract(this).getLength()}getLength(){return Math.sqrt(this.x*this.x+this.y*this.y)}}const u=(s,t,i)=>s+(t-s)*i,A=(s,t,i)=>new h(u(s.x,t.x,i),u(s.y,t.y,i));class r{constructor({getCurrentValue:t,targetValue:i,duration:e,delay:a=0}){n(this,"startValue");n(this,"getCurrentValue");n(this,"targetValue");n(this,"startTime");n(this,"duration");n(this,"isFinished");this.startValue=null,this.getCurrentValue=t,this.targetValue=i,this.duration=e,this.startTime=Date.now()+a,this.isFinished=!1}get runningTime(){return Date.now()-this.startTime}hasStarted(){return this.runningTime>=0}isVectorAnimation(){return this.targetValue instanceof h}isNumberAnimation(){return typeof this.targetValue=="number"}tick(){const t=this.runningTime/this.duration;if(!this.hasStarted())return this.getCurrentValue();if(this.runningTime>=this.duration)return this.isFinished=!0,this.targetValue;if(this.startValue===null)return this.startValue=this.getCurrentValue(),this.startValue;if(this.isVectorAnimation())return A(this.startValue,this.targetValue,t);if(this.isNumberAnimation())return u(this.startValue,this.targetValue,t);throw new Error("Invalid animation")}}class V{constructor({ctx:t,label:i,position:e,fontSize:a=24,fontFamily:l="Inter",color:o=getComputedStyle(t.canvas).getPropertyValue("--fg"),rotation:g=0,opacity:m=1,textAlign:d="center",rotationOrigin:c="center"}){n(this,"ctx");n(this,"label");n(this,"font");n(this,"color");n(this,"textAlign");n(this,"positionAnimations");n(this,"position");n(this,"opacityAnimations");n(this,"opacity");n(this,"rotationAnimations");n(this,"rotation");n(this,"rotationOrigin");this.ctx=t,this.label=i,this.font=`${a}px ${l}`,this.color=o,this.textAlign=d,this.positionAnimations=[],this.position=e,this.opacityAnimations=[],this.opacity=m,this.rotationAnimations=[],this.rotation=g,this.rotationOrigin=c}animatePosition(t,i,e=0){return this.positionAnimations.push(new r({getCurrentValue:()=>this.position,targetValue:t,duration:i,delay:e})),this}animateOpacity(t,i,e=0){return this.opacityAnimations.push(new r({getCurrentValue:()=>this.opacity,targetValue:t,duration:i,delay:e})),this}animateRotation(t,i,e=0){return this.rotationAnimations.push(new r({getCurrentValue:()=>this.rotation,targetValue:t,duration:i,delay:e})),this}update(){for(const t of this.positionAnimations)!t.hasStarted()||t.isFinished||(this.position=t.tick());for(const t of this.opacityAnimations)!t.hasStarted()||t.isFinished||(this.opacity=t.tick());for(const t of this.rotationAnimations)!t.hasStarted()||t.isFinished||(this.rotation=t.tick())}draw(t){t.save(),t.textAlign=this.textAlign,t.textBaseline="middle",t.globalAlpha=this.opacity,t.fillStyle=this.color,t.font=this.font;const i=t.measureText(this.label).width;this.rotationOrigin==="left"&&t.translate(-i/2,0),this.rotationOrigin==="right"&&t.translate(i/2,0),t.translate(this.position.x,this.position.y),t.rotate(this.rotation),this.rotationOrigin==="left"&&t.translate(i/2,0),this.rotationOrigin==="right"&&t.translate(-i/2,0),t.fillText(this.label,0,0),t.restore()}tick(){return this.update(),this.draw(this.ctx),(this.opacityAnimations.every(t=>t.isFinished)??!0)&&(this.positionAnimations.every(t=>t.isFinished)??!0)&&(this.rotationAnimations.every(t=>t.isFinished)??!0)}}class w{constructor({ctx:t,startPosition:i,targetPosition:e,color:a=getComputedStyle(t.canvas).getPropertyValue("--fg")}){n(this,"ctx");n(this,"color");n(this,"drawingAnimations");n(this,"startPosition");n(this,"targetPosition");n(this,"endPosition");this.ctx=t,this.color=a,this.startPosition=i,this.targetPosition=e,this.endPosition=e,this.drawingAnimations=[]}animateDrawing(t,i=0){return this.endPosition=this.startPosition,this.drawingAnimations.push(new r({getCurrentValue:()=>this.startPosition,targetValue:this.targetPosition,duration:t,delay:i})),this}update(){for(const t of this.drawingAnimations)!t.hasStarted()||t.isFinished||(this.endPosition=t.tick())}draw(t){t.strokeStyle=this.color,t.beginPath(),t.moveTo(this.startPosition.x,this.startPosition.y),t.lineTo(this.endPosition.x,this.endPosition.y),t.stroke()}tick(){return this.update(),this.draw(this.ctx),this.drawingAnimations.every(t=>t.isFinished)??!0}}const P=(s,t,i=[])=>new Promise(e=>{const a=()=>{s.clearRect(0,0,s.canvas.width,s.canvas.height),i.forEach(o=>o.draw(s)),t.map(o=>o.tick()).every(Boolean)?e():requestAnimationFrame(a)};a()}),F=(...s)=>{const t=[];for(let i=0;i<s[0].length;i++){t[i]=[];for(let e=0;e<s.length;e++)t[i][e]=s[e][i]}return t},b=s=>s.reduce((t,i)=>t+i,0);export{V as A,h as V,w as a,P as r,b as s,F as z};
