var $=Object.defineProperty;var D=(i,t,n)=>t in i?$(i,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[t]=n;var o=(i,t,n)=>D(i,typeof t!="symbol"?t+"":t,n);class c{constructor(t,n){o(this,"x");o(this,"y");this.x=t,this.y=n}subtract(t){return new c(this.x-t.x,this.y-t.y)}distanceTo(t){return t.subtract(this).getLength()}getLength(){return Math.sqrt(this.x*this.x+this.y*this.y)}}const S=(i,t,n)=>i+(t-i)*n,R=(i,t,n)=>new c(S(i.x,t.x,n),S(i.y,t.y,n));class f{constructor({getCurrentValue:t,targetValue:n,duration:s,delay:r=0}){o(this,"startValue");o(this,"getCurrentValue");o(this,"targetValue");o(this,"startTime");o(this,"duration");o(this,"isFinished");this.startValue=null,this.getCurrentValue=t,this.targetValue=n,this.duration=s,this.startTime=Date.now()+r,this.isFinished=!1}get runningTime(){return Date.now()-this.startTime}hasStarted(){return this.runningTime>=0}isVectorAnimation(){return this.targetValue instanceof c}isNumberAnimation(){return typeof this.targetValue=="number"}tick(){const t=this.runningTime/this.duration;if(!this.hasStarted())return this.getCurrentValue();if(this.runningTime>=this.duration)return this.isFinished=!0,this.targetValue;if(this.startValue===null)return this.startValue=this.getCurrentValue(),this.startValue;if(this.isVectorAnimation())return R(this.startValue,this.targetValue,t);if(this.isNumberAnimation())return S(this.startValue,this.targetValue,t);throw new Error("Invalid animation")}}class g{constructor({ctx:t,label:n,position:s,font:r="24px Inter",color:u=getComputedStyle(t.canvas).getPropertyValue("--fg"),rotation:e=0,opacity:l=1,textAlign:a="center"}){o(this,"ctx");o(this,"label");o(this,"font");o(this,"color");o(this,"textAlign");o(this,"positionAnimations");o(this,"position");o(this,"opacityAnimations");o(this,"opacity");o(this,"rotationAnimations");o(this,"rotation");this.ctx=t,this.label=n,this.font=r,this.color=u,this.textAlign=a,this.positionAnimations=[],this.position=s,this.opacityAnimations=[],this.opacity=l,this.rotationAnimations=[],this.rotation=e}animatePosition(t,n,s=0){return this.positionAnimations.push(new f({getCurrentValue:()=>this.position,targetValue:t,duration:n,delay:s})),this}animateOpacity(t,n,s=0){return this.opacityAnimations.push(new f({getCurrentValue:()=>this.opacity,targetValue:t,duration:n,delay:s})),this}animateRotation(t,n,s=0){return this.rotationAnimations.push(new f({getCurrentValue:()=>this.rotation,targetValue:t,duration:n,delay:s})),this}update(){for(const t of this.positionAnimations)!t.hasStarted()||t.isFinished||(this.position=t.tick());for(const t of this.opacityAnimations)!t.hasStarted()||t.isFinished||(this.opacity=t.tick());for(const t of this.rotationAnimations)!t.hasStarted()||t.isFinished||(this.rotation=t.tick())}draw(t){t.save(),t.textAlign=this.textAlign,t.textBaseline="middle",t.globalAlpha=this.opacity,t.fillStyle=this.color,t.font=this.font,t.translate(this.position.x,this.position.y),t.rotate(this.rotation),t.fillText(this.label,0,0),t.restore()}tick(){return this.update(),this.draw(this.ctx),(this.opacityAnimations.every(t=>t.isFinished)??!0)&&(this.positionAnimations.every(t=>t.isFinished)??!0)&&(this.rotationAnimations.every(t=>t.isFinished)??!0)}}class O{constructor({ctx:t,startPosition:n,targetPosition:s,color:r=getComputedStyle(t.canvas).getPropertyValue("--fg")}){o(this,"ctx");o(this,"color");o(this,"drawingAnimations");o(this,"startPosition");o(this,"targetPosition");o(this,"endPosition");this.ctx=t,this.color=r,this.startPosition=n,this.targetPosition=s,this.endPosition=s,this.drawingAnimations=[]}animateDrawing(t,n=0){return this.endPosition=this.startPosition,this.drawingAnimations.push(new f({getCurrentValue:()=>this.startPosition,targetValue:this.targetPosition,duration:t,delay:n})),this}update(){for(const t of this.drawingAnimations)!t.hasStarted()||t.isFinished||(this.endPosition=t.tick())}draw(t){t.strokeStyle=this.color,t.beginPath(),t.moveTo(this.startPosition.x,this.startPosition.y),t.lineTo(this.endPosition.x,this.endPosition.y),t.stroke()}tick(){return this.update(),this.draw(this.ctx),this.drawingAnimations.every(t=>t.isFinished)??!0}}const w=(i,t,n=[])=>new Promise(s=>{const r=()=>{i.clearRect(0,0,i.canvas.width,i.canvas.height),n.forEach(e=>e.draw(i)),t.map(e=>e.tick()).every(Boolean)?s():requestAnimationFrame(r)};r()}),C=(...i)=>{const t=[];for(let n=0;n<i[0].length;n++){t[n]=[];for(let s=0;s<i.length;s++)t[n][s]=i[s][n]}return t},N=i=>i.reduce((t,n)=>t+n,0),I=`3   4
4   3
2   5
1   3
3   9
3   3`,y=200,P=100,b=200,Y=24,W=async i=>{i.clearRect(0,0,i.canvas.width,i.canvas.height);const t=I.split(`
`).map(A=>A.split("   ").map(Number)),[n,s]=C(...t),r=[...n].sort((A,v)=>A-v),u=[...s].sort((A,v)=>A-v),e=T(i,n,-b/2),l=T(i,s,b/2),a=[...e,...l];await w(i,a);const[h,p]=q(i,r,u);await w(i,h,a);const d=z(i,p);await w(i,d,[...h,...a])},T=(i,t,n)=>{const s=t.map((u,e)=>({value:u,id:e})),r=[...s].sort((u,e)=>u.value-e.value);return s.map((u,e)=>{const l=r.findIndex(d=>d.id===u.id),a=i.canvas.width/2+n,h=new c(a,y+e*P),p=new c(a,y+l*P);return new g({ctx:i,position:h,opacity:0,label:u.value.toString(),font:`${Y}px Inter`}).animateOpacity(1,500).animatePosition(p,1e3,1e3)})},q=(i,t,n)=>{const s=[],r=[],e=t.length;for(let l=0;l<e;l++){const a=y+P*l,h=Math.abs(t[l]-n[l]);r.push(h),s.push(new O({ctx:i,startPosition:new c(i.canvas.width/2-b/2+20,a),targetPosition:new c(i.canvas.width/2-20,a)}).animateDrawing(500,l*100)),s.push(new O({ctx:i,startPosition:new c(i.canvas.width/2+b/2-20,a),targetPosition:new c(i.canvas.width/2+20,a)}).animateDrawing(500,l*100));const p=new c(i.canvas.width/2,y+l*P);s.push(new g({ctx:i,position:p,label:h.toString(),opacity:0}).animateOpacity(1,500,l*100))}return[s,r]},z=(i,t)=>{const n=N(t),s=new g({ctx:i,position:new c(i.canvas.width/2,y-30),rotation:Math.PI/2,opacity:0,label:"="}).animateOpacity(1,500),r=new g({ctx:i,position:new c(i.canvas.width/2,y-60),opacity:0,label:n.toString()}).animateOpacity(1,500);return console.log("Part 1:",n),[s,r]},m=200,F=100,V=200,E=24,X=async i=>{i.clearRect(0,0,i.canvas.width,i.canvas.height);const t=I.split(`
`).map(a=>a.split("   ").map(Number)),[n,s]=C(...t),r=k(i,n,-V/2),u=k(i,s,V/2),e=[...r,...u];await w(i,e);let l=0;for(let a=0;a<n.length;a++){const[h,p]=M(i,n,s,a),d=p?L(i,l):[];await w(i,[...h,...d],e),l+=p}await w(i,L(i,l),e),console.log("Part 2",l)},k=(i,t,n)=>t.map((s,r)=>{const u=i.canvas.width/2+n,e=new c(u,m+r*F);return new g({ctx:i,position:e,opacity:0,label:s.toString(),font:`${E}px Inter`}).animateOpacity(1,500)}),M=(i,t,n,s)=>{const r=t[s],u=n.map((a,h)=>a===r?h:-1).filter(a=>a!==-1),e=[];u.forEach((a,h)=>{const p=new c(i.canvas.width/2-V/2,m+s*F),d=new c(i.canvas.width/2+V/2,m+a*F);e.push(new O({ctx:i,startPosition:p,targetPosition:d}).animateDrawing(500,h*500))});const l=u.length*r;if(l>0){const a=i.canvas.width/2,h=u.length*500;e.push(new g({ctx:i,position:new c(a-30,m),label:u.length.toString(),opacity:0}).animateOpacity(1,500,h).animatePosition(new c(a,m),500,h+500).animateOpacity(0,500,h+500)),e.push(new g({ctx:i,position:new c(a,m),label:"*",opacity:0}).animateOpacity(1,500,h).animateOpacity(0,500,h+500)),e.push(new g({ctx:i,position:new c(a+30,m),label:r.toString(),opacity:0}).animateOpacity(1,500,h).animatePosition(new c(a,m),500,h+500).animateOpacity(0,500,h+500)),e.push(new g({ctx:i,position:new c(a,m),label:`+ ${l.toString()}`,opacity:0}).animateOpacity(1,250,h+1e3).animatePosition(new c(a,m-25),250,h+1250).animateOpacity(0,250,h+1300))}return[e,l]},L=(i,t)=>{const n=[];return n.push(new g({ctx:i,label:t.toString(),position:new c(i.canvas.width/2,m-50),opacity:0}).animateOpacity(1,500)),n};export{W as part1,X as part2};
